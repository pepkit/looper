<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script type="text/javascript">
    var plotDict = {}; // variable containing column values (col_name:string -> col_values:list)
    var statsTable = {{ stats_json }}; // Jinja template variable
    var columns = {{ columns_json }}; // Jinja template variable
    const sampleNames = Object.keys(statsTable);

    for (var i in columns){
        column = columns[i]
        if (column === "sample_name") { continue; }
        plotDict[column] = []
        for (var j in sampleNames){
            plotDict[column].push(parseFloat(statsTable[sampleNames[j]][column]))
        }
    }

    console.log(plotDict);

    function graphCol(colname){
      /* Creates a graph using Plotly.js */
      var data = [{
          y: plotDict[colname],
          x: sampleNames,
          type: 'bar'
      }];
      var title = colname.replace("_", " ");
      var layout = {
          title: title
      };
      chart = document.getElementById('charts');
      Plotly.newPlot(chart, data, layout);
    }
    
    function displayPlottableColumns(){
        for(var col in plotDict){
            $("#plot-cols").append("<a class='list-group-item list-group-item-action' href='#' onclick='graphCol(\"" + col + "\");return false;'>" + col+ "</a>");
        }
    }

    displayPlottableColumns();
</script>